<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous" />
    <title>KeyToKey Release Notes</title>

    <style>
        body {
            background-color: #212121;
            color: #e7e7e7;
        }

        li {
            padding: 5px 0 5px;
        }

        .no-dot {
            list-style: none;
        }

        kbd {
            background-color: #e1e1e1;
            color: black;
            margin: 0 10px;
        }

        table thead th {
            color: #e7e7e7;
        }

        .th-col-state {
            color: #e7e7e7;
            width: 65px;
            text-align: center;
        }

        table tbody tr td {
            color: #e7e7e7;
        }

        table tbody tr td pre {
            color: #e7e7e7;
        }
    </style>

</head>

<body>

    <div class="container py-5 mb-5">
        <div class="alert alert-danger">
            <h4 class="alert-heading">重要なお知らせ</h4>
            <hr>
            <p>20年10月05日のアップデートにおいて高 DPI 環境における、画像のキャプチャに関する不具合の修正を行いました。この修正はモニターの表示倍率を変更している方に影響があり、以下の設定に影響を与えます。</p>
            <ul>
                <li class="font-weight-bold">画像認識を行う座標設定</li>
                <li class="font-weight-bold">アクション「画像を保存」の座標設定</li>
            </ul>
        </div>
        <div class="alert alert-danger">
            <h4 class="alert-heading">重要なお知らせ</h4>
            <hr>
            <p>KeyToKeyの実行に必要な.Net Frameworkのバージョンを<b>「4.6.2」</b>から<b>「4.8」</b>へと引き上げました。</p>
        </div>
        <h2 class="mt-5">変更点</h2>
        <ul>
            <li>C#スクリプトエディタでスクロールが出来ない問題を修正しました。</li>
            <li>C#スクリプトエディタでテンプレートコードの挿入をできるようにしました。</li>
            <li>C#スクリプトエディタでコンパイルテストをできるようにしました。</li>
            <li>入力の記録で C#スクリプト用にデータをコピーできるようにしました。</li>
            <li>割り当て設定（コントローラー）のリストを廃止し、コントローラーの画像で割り当てられるようにしました。</li>
            <li><span class="text-success font-weight-bold">入力の可視化</span>に<span class="text-success font-weight-bold">現在押しているキー</span>を追加しました。</li>
            <li><kbd>半角／全角</kbd>キーに割り当てをできるようにしました。</li>
            <li>
                各種割り当ての一部設定の変更を行いました。
                <ul class="px-3 no-dot">
                    <li><span class="text-danger font-weight-bold">削除</span>トリガーの連続入力をキャンセルする</li>
                    <li><span class="text-danger font-weight-bold">削除</span>トリガーの最初の入力をキャンセルする</li>
                    <li><span class="text-success">追加</span>トリガーの入力をキャンセルする</li>
                </ul>
            </li>
            <li>円形メニューの挙動の調整を行いました。</li>
            <li>引数やローカル変数のリストを折りたためられるようにしました。</li>
            <li>アプリケーションの設定の<span class="text-success font-weight-bold">マクロの作成・設定／アクション</span>カテゴリに<span class="text-success font-weight-bold">起動時のタブ</span>を追加しました。</li>
            <li>設定ファイルをコピーして作成するときにコピー元のスクリプトフォルダを新しい設定ファイル用にコピーするようにしました。</li>
        </ul>
        <h2 class="mt-5 mb-3">スクリプトエディタのショートカット</h2>
        <p>以下のショートカットをエディタに追加しました。</p>
        <table class="table table-striped table-dark my-4 table-bordered">
            <thead class=" thead-dark">
                <th>アクション</th>
                <th>ショートカットキー</th>
            </thead>
            <tbody>
                <tr>
                    <td>行の複製</td>
                    <td><kbd>Ctrl + D</kbd></td>
                </tr>
                <tr>
                    <td>行を上に移動</td>
                    <td><kbd>Alt + ↑</kbd></td>
                </tr>
                <tr>
                    <td>行を下にに移動</td>
                    <td><kbd>Alt + ↓</kbd></td>
                </tr>
                <tr>
                    <td>行をコメントアウト</td>
                    <td><kbd>Ctrl + K</kbd>+<kbd>Ctrl + C</kbd></td>
                </tr>
                <tr>
                    <td>行のコメントアウトを解除</td>
                    <td><kbd>Ctrl + K</kbd>+<kbd>Ctrl + U</kbd></td>
                </tr>
                <tr>
                    <td>テンプレートの挿入</td>
                    <td><kbd>Ctrl + T</kbd></td>
                </tr>
                <tr>
                    <td>行の削除</td>
                    <td><kbd>Shift + Delete</kbd></td>
                </tr>
            </tbody>
        </table>
        <h2 class="mt-5 mb-3">C#スクリプトの変更点</h2>

        <table class="table table-dark table- my-4 table-bordered table-triped">
            <thead>
                <tr>
                    <th class="th-col-state">状態</th>
                    <th style="text-align: center;">内容</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-danger font-weight-bold">削除</td>
                    <td>IME.Mode { get; }</td>
                </tr>
                <tr>
                    <td class="text-danger font-weight-bold">削除</td>
                    <td>IME.SetConversionMode { get; }</td>
                </tr>
                <tr>
                    <td class="text-warning font-weight-bold">変更</td>
                    <td>
                        void CreateDirectory(string path) を
                        string CreateDirectory(params string[] path)に変更しました。
                    </td>
                </tr>
                <tr>
                    <td class="text-warning font-weight-bold">変更</td>
                    <td>
                        Match()メソッドで画像認識に失敗した時も結果を取得できるようにしました。
                    </td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>event Hooked</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>IME.ConversinMode { get; set; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>ActiveWindowClientBounds { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Controller.Trigger.ThumbAsByte { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Controller.Stick.ThumbAsShort { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>TemplateMatching.Configs { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Parameters { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>LocalVariables { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>GlobalVariables { get; }</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>GetDpiFromPoint(int x, int y)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>GetDpiFromPoint(Bounds bounds)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>GetDpiFromWindowHandle(IntPtr handle)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>GetBoundsByWindow(WindowPopLocation pop)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Bounds.ToCenter()</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Bounds.ToEvenNumber()</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Bounds.ToOddNumber()</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Bounds.ToInsideOf(Bounds bounds)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Angle(x1, y1, x2, y2, isClockwise)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Distance(x1, y1, x2, y2)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Clamp(min, max, value)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Controller.GetThumbsAsShort()</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>IsTrigger(Keys key)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>IsTrigger(ControllerButtons button)</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>Abort()</td>
                </tr>
                <tr>
                    <td class="text-success font-weight-bold">追加</td>
                    <td>CreateWaiter(bool highPricisionWait = false)</td>
                </tr>
            </tbody>
        </table>

        <a href="/update2.html" class="btn btn-primary">過去の更新履歴</a>

    </div>


    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
</body>

</html>